(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47271,       1019]
NotebookOptionsPosition[     46208,        993]
NotebookOutlinePosition[     46582,       1010]
CellTagsIndexPosition[     46539,       1007]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Clean", " ", "stuff"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]}]], "Input",
 CellChangeTimes->{{3.748757032830659*^9, 3.748757042286455*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"bfcec826-eaec-4a83-992d-6e9e02e6819d"],

Cell[CellGroupData[{

Cell["Probability Declarations", "Section",
 CellChangeTimes->{{3.7487570669427853`*^9, 
  3.748757072054542*^9}},ExpressionUUID->"09ea2822-3c08-4072-bb7f-\
327051056910"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"probUnifom", "[", 
    RowBox[{"x_", ",", " ", "xmin_", ",", " ", "xmax_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"HeavisideTheta", "[", 
     RowBox[{"x", "-", "xmin"}], "]"}], " ", 
    RowBox[{"HeavisideTheta", "[", 
     RowBox[{"xmax", "-", "x"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"probUniformNeg", "[", 
    RowBox[{
    "x_", ",", " ", "xmin_", ",", " ", "xmax_", ",", " ", "a_", ",", " ", 
     "b_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"probUnifom", "[", 
     RowBox[{"x", ",", " ", "a", ",", " ", "xmin"}], "]"}], " ", "+", " ", 
    RowBox[{"probUnifom", "[", 
     RowBox[{"x", ",", " ", "xmax", ",", " ", "b"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7487569973197517`*^9, 3.7487570073182364`*^9}, {
  3.748768798525031*^9, 3.748768832917324*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"59df87fe-7b84-4db1-a615-66cec0424fb4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Algorithm", "Section",
 CellChangeTimes->{{3.748757079070859*^9, 
  3.748757080318564*^9}},ExpressionUUID->"733d2676-ca2f-47ee-882c-\
bb5dc7085eca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Interval", " ", "Lengths", " ", "a"}], ",", " ", "b"}], "*)"}], 
  " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"b", "=", " ", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Central", " ", "and", " ", "sigma", " ", "value", " ", "for", " ", 
     "N1"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]", " ", "=", " ", "0.25"}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"pltRange", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "-", "1"}], ",", " ", 
        RowBox[{"b", "+", "1"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1.5"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"randomGenNb", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Initial", " ", "uniform", " ", "probability"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P0", "  ", "=", 
     FractionBox[
      RowBox[{"1", " "}], 
      RowBox[{"(", 
       RowBox[{"b", "-", "a"}], ")"}]]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InitialProb", " ", "=", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"(", 
        RowBox[{"b", "-", "a"}], ")"}]], "*", 
      RowBox[{"probUnifom", "[", 
       RowBox[{"x", ",", "a", ",", " ", "b"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Mu]", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{"a", ",", " ", "b"}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"PD2", "=", 
     RowBox[{"ProbabilityDistribution", "[", 
      RowBox[{"InitialProb", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "a", ",", "b"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"complementPDF", " ", "=", " ", "0"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"newSigma", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"While", " ", "[", " ", 
      RowBox[{
       RowBox[{"randomGenNb", "\[LessEqual]", "300"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", " ", 
        RowBox[{
         RowBox[{"0.9", "\[LessEqual]", " ", 
          RowBox[{"Sin", "[", "\[Mu]", "]"}], " ", "\[LessEqual]", " ", "1"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Found one!\>\"", "]"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"complementPDFAux", " ", "=", " ", "complementPDF"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newSigmaAux", "=", "newSigma"}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"combPDFres2", " ", "=", " ", 
           RowBox[{"addToStepDist", "[", 
            RowBox[{
            "complementPDFAux", ",", " ", "newSigmaAux", ",", " ", "\[Mu]", 
             ",", " ", "\[Sigma]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"complementPDF", " ", "=", 
           RowBox[{"combPDFres2", "[", 
            RowBox[{"[", " ", "1", " ", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newSigma", " ", "=", " ", 
           RowBox[{"combPDFres2", "[", 
            RowBox[{"[", " ", "2", " ", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"complementPDF", " ", "=", " ", 
             RowBox[{"complementPDF", " ", "+", " ", 
              RowBox[{"probUnifom", "[", 
               RowBox[{"x", ",", "  ", 
                RowBox[{"\[Mu]", "-", 
                 RowBox[{"(", 
                  RowBox[{"\[Sigma]", "/", "10"}], ")"}]}], ",", " ", 
                RowBox[{"\[Mu]", "+", 
                 RowBox[{"(", 
                  RowBox[{"\[Sigma]", "/", "10"}], ")"}]}]}], "]"}]}]}], 
            ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"newArea2", " ", "=", 
             RowBox[{"Quiet", "[", " ", 
              RowBox[{"NIntegrate", "[", 
               RowBox[{"complementPDF", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"x", ",", " ", "1", ",", " ", "b"}], "}"}]}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"rescFact2", " ", "=", " ", 
             RowBox[{"1", "/", "newArea2"}]}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"complementPDF", " ", "=", " ", 
             RowBox[{"rescFact2", " ", "*", " ", "complementPDF"}]}], " ", 
            ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"lineStyle", "=", 
           RowBox[{"{", 
            RowBox[{"Green", ",", "Dashed"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"minus\[Sigma]line", " ", "=", " ", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Mu]", " ", "-", " ", "\[Sigma]"}], ",", "0"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Mu]", "-", "\[Sigma]"}], ",", "100"}], "}"}]}], 
             "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"plus\[Sigma]line", " ", "=", " ", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Mu]", " ", "+", " ", "\[Sigma]"}], ",", "0"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Mu]", "+", "\[Sigma]"}], ",", "100"}], "}"}]}], 
             "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"posProbPlot", " ", "=", 
           RowBox[{"Plot", "[", "\[IndentingNewLine]", 
            RowBox[{"complementPDF", ",", " ", 
             RowBox[{"{", 
              RowBox[{"x", ",", " ", "a", ",", " ", "b"}], "}"}], ",", "  ", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", " ", 
             RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "pltRange"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", " ", 
             "\[IndentingNewLine]", 
             RowBox[{"Filling", "\[Rule]", "Axis"}]}], "\[IndentingNewLine]", 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"probPlot", " ", "=", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", " ", 
               RowBox[{"PDF2", ",", " ", "InitialProb", ",", " ", 
                FractionBox["1", 
                 RowBox[{"(", 
                  RowBox[{"b", "-", "a"}], ")"}]]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"x", ",", "a", ",", "b"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", " ", 
              RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotRange", "\[Rule]", "pltRange"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Epilog", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Directive", "[", "lineStyle", "]"}], ",", " ", 
                 "minus\[Sigma]line", ",", " ", "plus\[Sigma]line", ",", " ", 
                 "Green", ",", 
                 RowBox[{"PointSize", "@", "Large"}], ",", 
                 "\[IndentingNewLine]", "\t       ", 
                 RowBox[{"Point", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Mu]", ",", "0.001"}], "}"}], "]"}]}], " ", 
                "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", "  ", 
              RowBox[{"Filling", "\[Rule]", "Axis"}]}], "\[IndentingNewLine]",
              "]"}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{",", "\[IndentingNewLine]", 
              RowBox[{"Histogram", "[", 
               RowBox[{
               "data", ",", "50", ",", "\"\<ProbabilityDensity\>\"", ",", 
                "  ", 
                RowBox[{"PlotRange", "\[Rule]", "pltRange"}]}], "]"}]}], 
             "*)"}], "\[IndentingNewLine]", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"randomGenNb", " ", "++"}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"\[Mu]", " ", "=", " ", 
           RowBox[{"RandomVariate", "[", "PD2", "]"}]}], ";"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Pause", "[", "1", "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{"DentingProb", " ", "=", "  ", 
           RowBox[{"probUniformNeg", "[", 
            RowBox[{"x", ",", " ", 
             RowBox[{"\[Mu]", "-", "\[Sigma]"}], ",", " ", 
             RowBox[{"\[Mu]", "+", "\[Sigma]"}], ",", " ", "a", ",", " ", 
             "b"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"newArea", " ", "=", 
           RowBox[{"Quiet", "[", " ", 
            RowBox[{"NIntegrate", "[", 
             RowBox[{
              RowBox[{"InitialProb", " ", "*", " ", "DentingProb"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"x", ",", " ", "1", ",", " ", "b"}], "}"}]}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"rescFact", " ", "=", " ", 
           RowBox[{"1", "/", "newArea"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"PDF2", "=", 
           RowBox[{
           "rescFact", "*", "InitialProb", " ", "*", " ", "DentingProb"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"totalProb", " ", "=", " ", 
             RowBox[{"Quiet", "[", " ", 
              RowBox[{"NIntegrate", "[", 
               RowBox[{"PDF2", ",", " ", 
                RowBox[{"{", 
                 RowBox[{"x", ",", " ", "a", ",", " ", "b"}], "}"}]}], "]"}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Checking that the total probability is : \>\"", ",", " ", 
              "totalProb"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"PD2", "=", 
           RowBox[{"ProbabilityDistribution", "[", 
            RowBox[{"PDF2", ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", "a", ",", "b"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"data", "=", 
             RowBox[{"RandomVariate", "[", 
              RowBox[{"PD2", ",", 
               RowBox[{"10", "^", "5"}]}], "]"}]}], ";"}], "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", " ", "[", 
             RowBox[{
             "\"\<New Random Variate\>\"", ",", " ", "newRandomVariate"}], 
             "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]",
           "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"{", 
            RowBox[{"Red", ",", 
             RowBox[{"PointSize", "@", "Large"}], ",", 
             RowBox[{"Point", "[", 
              RowBox[{"{", 
               RowBox[{"\[Mu]", ",", "0"}], "}"}], "]"}]}], "}"}], "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"lineStyle", "=", 
           RowBox[{"{", 
            RowBox[{"Red", ",", "Dashed"}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"lineStyle2", "=", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", "Dashed"}], "}"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"lineStyle3", "=", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", "Dashed"}], "}"}]}], ";"}], "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"minus\[Sigma]line", " ", "=", " ", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Mu]", " ", "-", " ", "\[Sigma]"}], ",", "0"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Mu]", "-", "\[Sigma]"}], ",", "100"}], "}"}]}], 
             "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"plus\[Sigma]line", " ", "=", " ", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Mu]", " ", "+", " ", "\[Sigma]"}], ",", "0"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[Mu]", "+", "\[Sigma]"}], ",", "100"}], "}"}]}], 
             "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"complementPD", "=", 
             RowBox[{"ProbabilityDistribution", "[", 
              RowBox[{"complementPDF", ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", "a", ",", "b"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"dataProb", "=", 
             RowBox[{"RandomVariate", "[", 
              RowBox[{"complementPD", ",", 
               RowBox[{"10", "^", "5"}]}], "]"}]}], ";"}], "\n", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"posProbPlot", " ", "=", " ", "\[IndentingNewLine]", 
           RowBox[{"Plot", "[", "\[IndentingNewLine]", 
            RowBox[{"complementPDF", ",", " ", 
             RowBox[{"{", 
              RowBox[{"x", ",", " ", "a", ",", " ", "b"}], "}"}], ",", "  ", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", " ", 
             RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"PlotRange", "\[Rule]", "pltRange"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Filling", "\[Rule]", "Axis"}]}], "\[IndentingNewLine]", 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"probPlot", " ", "=", 
           RowBox[{"Show", "[", "\[IndentingNewLine]", 
            RowBox[{"Plot", "[", 
             RowBox[{
              RowBox[{"{", " ", 
               RowBox[{"PDF2", ",", " ", "InitialProb", ",", " ", 
                FractionBox["1", 
                 RowBox[{"(", 
                  RowBox[{"b", "-", "a"}], ")"}]]}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"x", ",", "a", ",", "b"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", " ", 
              RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"PlotRange", "\[Rule]", "pltRange"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Epilog", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Directive", "[", "lineStyle", "]"}], ",", " ", 
                 "minus\[Sigma]line", ",", " ", "plus\[Sigma]line", ",", " ", 
                 "Red", ",", 
                 RowBox[{"PointSize", "@", "Large"}], ",", 
                 "\[IndentingNewLine]", "\t       ", 
                 RowBox[{"Point", "[", 
                  RowBox[{"{", 
                   RowBox[{"\[Mu]", ",", "0.001"}], "}"}], "]"}]}], " ", 
                "}"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", " ", 
              RowBox[{"Filling", "\[Rule]", "Axis"}]}], "\[IndentingNewLine]",
              "]"}], "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{",", "\[IndentingNewLine]", 
              RowBox[{"Histogram", "[", 
               RowBox[{
               "data", ",", "50", ",", "\"\<ProbabilityDensity\>\"", ",", 
                "  ", 
                RowBox[{"PlotRange", "\[Rule]", "pltRange"}]}], "]"}]}], 
             "*)"}], "\[IndentingNewLine]", "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"InitialProb", " ", "=", " ", "PDF2"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Mu]", " ", "=", " ", 
           RowBox[{"RandomVariate", "[", "PD2", "]"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"randomGenNb", " ", "++"}], ";"}]}], " ", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Pause", "[", "1", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "]"}]}], "\t", "\[IndentingNewLine]", "]"}], 
     "\[IndentingNewLine]", ",", " ", 
     RowBox[{"{", 
      RowBox[{"probPlot", ",", " ", "posProbPlot"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"probPlot", ",", " ", "posProbPlot"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7487570851428413`*^9, 3.7487572475535593`*^9}, {
   3.748757290297773*^9, 3.748757329402938*^9}, {3.7487573754109983`*^9, 
   3.748757507229397*^9}, {3.748757538950102*^9, 3.748757675343534*^9}, {
   3.748757724656569*^9, 3.748757724848383*^9}, {3.748758066213524*^9, 
   3.7487580923813267`*^9}, {3.7487582002638197`*^9, 3.748758205574843*^9}, {
   3.748758245055873*^9, 3.748758245207779*^9}, {3.748758294431279*^9, 
   3.7487583261923437`*^9}, {3.748758385529951*^9, 3.748758428409977*^9}, {
   3.74875846253057*^9, 3.7487585044397907`*^9}, {3.748758542811427*^9, 
   3.748758584740233*^9}, {3.748758627164608*^9, 3.748758631924531*^9}, 
   3.7487586658281183`*^9, {3.7487587235912247`*^9, 3.748758737442013*^9}, {
   3.748758770847208*^9, 3.748758793559449*^9}, {3.748758875984644*^9, 
   3.748758904841399*^9}, {3.748758944872972*^9, 3.748758954192985*^9}, {
   3.748758993450561*^9, 3.748758998305525*^9}, {3.748759028809956*^9, 
   3.74875910248342*^9}, {3.748759156180957*^9, 3.748759161134293*^9}, {
   3.748759202204577*^9, 3.748759234869028*^9}, {3.748759273677196*^9, 
   3.748759281181467*^9}, {3.74875931611102*^9, 3.748759387191378*^9}, {
   3.748759435136745*^9, 3.748759602794224*^9}, {3.748759636306704*^9, 
   3.748759665914898*^9}, {3.748761946258149*^9, 3.748761958226511*^9}, {
   3.748761992548072*^9, 3.748762068529128*^9}, {3.748762121725276*^9, 
   3.74876219389329*^9}, {3.7487623503195877`*^9, 3.7487624008804817`*^9}, {
   3.748762449008779*^9, 3.7487624616970663`*^9}, {3.7487625772335863`*^9, 
   3.748762586761496*^9}, {3.7487626638520203`*^9, 3.7487627028284903`*^9}, {
   3.748762747679243*^9, 3.7487628057490053`*^9}, {3.748762836637473*^9, 
   3.748762864053722*^9}, {3.7487628980987577`*^9, 3.748762971703217*^9}, {
   3.748763011785409*^9, 3.748763042792047*^9}, {3.748763095388907*^9, 
   3.748763095728642*^9}, {3.748763172402114*^9, 3.7487631822845907`*^9}, {
   3.748763279915885*^9, 3.748763313204167*^9}, {3.748763696680806*^9, 
   3.748763737650981*^9}, {3.74876385480516*^9, 3.7487638960288553`*^9}, {
   3.748768583509514*^9, 3.7487686471407967`*^9}, {3.748768710221883*^9, 
   3.748768745637953*^9}, {3.7487688883199177`*^9, 3.7487689716741447`*^9}, 
   3.748769008445375*^9, {3.748769101324854*^9, 3.748769243505481*^9}, {
   3.748769276118333*^9, 3.74876928954181*^9}, {3.748769340758003*^9, 
   3.7487693680146713`*^9}, {3.7487694064474287`*^9, 3.748769416815319*^9}, {
   3.7487695169037933`*^9, 3.7487695189939938`*^9}, {3.748769605934396*^9, 
   3.74876967363516*^9}, {3.748769773187529*^9, 3.74876977321241*^9}, {
   3.748769836774206*^9, 3.7487698545012083`*^9}, {3.748769944672894*^9, 
   3.7487699461588917`*^9}, {3.748782402583939*^9, 3.748782458689786*^9}, 
   3.7487825428449383`*^9, {3.748782629722876*^9, 3.748782634011088*^9}, {
   3.748782712324237*^9, 3.748782761955491*^9}, {3.748782819349903*^9, 
   3.748782819437131*^9}, {3.748782884664839*^9, 3.748782887718371*^9}, 
   3.7487829875867157`*^9, {3.748783079322431*^9, 3.7487830880962973`*^9}, {
   3.748783276663651*^9, 3.748783281571665*^9}, {3.7487833200693893`*^9, 
   3.748783533127575*^9}, {3.748795408670649*^9, 3.748795441360815*^9}, {
   3.748854650628242*^9, 3.748854678588574*^9}, {3.74885556039942*^9, 
   3.748855619640424*^9}, {3.748855656944243*^9, 3.748855775378441*^9}, {
   3.748855863935308*^9, 3.748855901011447*^9}, 3.7488560286229963`*^9, {
   3.748856082368222*^9, 3.7488560891985407`*^9}, {3.748856122024963*^9, 
   3.748856155287367*^9}, {3.7488562457858143`*^9, 3.748856245848641*^9}, {
   3.748856281930574*^9, 3.748856324057806*^9}, {3.7488564068611193`*^9, 
   3.748856410404257*^9}, {3.748856459740411*^9, 3.74885648811907*^9}, {
   3.7488565695018253`*^9, 3.7488566136057863`*^9}, {3.74885667754317*^9, 
   3.748856677614608*^9}, {3.748857383040124*^9, 3.748857394688015*^9}, {
   3.7488574331860113`*^9, 3.748857450112812*^9}, {3.7488575002975616`*^9, 
   3.7488575021626463`*^9}, {3.748859352597417*^9, 3.748859455406061*^9}, {
   3.7488595417439423`*^9, 3.74885954693569*^9}, {3.7488595882558203`*^9, 
   3.748859601695902*^9}, {3.748859679681449*^9, 3.748859684914418*^9}, {
   3.748861684005126*^9, 3.74886170519768*^9}, {3.7491183773465014`*^9, 
   3.749118384900878*^9}, {3.749118507112335*^9, 3.749118510695717*^9}, {
   3.7491185785001583`*^9, 3.7491185793446827`*^9}, {3.749118686402502*^9, 
   3.749118686858712*^9}, {3.749118987737142*^9, 3.749119002372067*^9}, {
   3.7491190686887083`*^9, 3.749119071487115*^9}, 3.749119104196026*^9, {
   3.749119163603015*^9, 3.749119181179492*^9}},
 CellLabel->
  "In[4025]:=",ExpressionUUID->"34530e34-0e7f-411b-9e19-707619d2244c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"addToStepDist", "[", 
   RowBox[{
   "probToAdd_", ",", "probHeight_", ",", " ", "\[Mu]2_", ",", " ", 
    "\[Sigma]2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", " ", 
     RowBox[{
     "PDF2", ",", " ", "combPDF", ",", " ", "newSigma", ",", " ", "newArea", 
      ",", " ", "rescalingFactor"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", " ", "[", "\"\<Inside the adding function.\>\"", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"PDF2", " ", "=", " ", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"2", "\[Sigma]2"}]], "*", 
       RowBox[{"probUnifom", "[", 
        RowBox[{"x", ",", " ", 
         RowBox[{"\[Mu]2", "-", "\[Sigma]2"}], ",", " ", 
         RowBox[{"\[Mu]2", "+", "\[Sigma]2"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"rescFactAux", " ", "=", " ", 
      RowBox[{"probHeight", " ", "/", " ", 
       FractionBox["1", 
        RowBox[{"2", "\[Sigma]2"}]]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"probToAdd", " ", "\[Equal]", " ", "0"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<In the case!!!\>\"", "]"}], ";"}], "*)"}],
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"PDF2", ",", 
           FractionBox["1", 
            RowBox[{"2", "\[Sigma]2"}]], ",", " ", "PDF2"}], " ", "}"}], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "Print", " ", "[", 
        "\"\<Don't have a 0 probability therefore fun time.\>\"", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "PDF2", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"PDF2", " ", "=", " ", 
      RowBox[{"PDF2", " ", "*", " ", "rescFactAux"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", " ", "[", "rescFactAux", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", " ", "[", "PDF2", "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"combPDF", " ", "=", " ", 
      RowBox[{"probToAdd", " ", "+", " ", "PDF2", "-", 
       RowBox[{
        FractionBox["1", "probHeight"], " ", "probToAdd", " ", "*", " ", 
        "PDF2"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", " ", "[", 
      RowBox[{"\"\<Integrating and rescalling\>\"", ",", " ", 
       RowBox[{"FontColor", "\[Rule]", " ", "Red"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"newArea", " ", "=", 
      RowBox[{"Quiet", "[", " ", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{"combPDF", ",", " ", 
         RowBox[{"{", 
          RowBox[{"x", ",", " ", "1", ",", " ", "10"}], "}"}]}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rescalingFactor", " ", "=", " ", 
      RowBox[{"1", "/", "newArea"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"combPDF", " ", "=", " ", 
      RowBox[{"rescalingFactor", " ", "*", " ", "combPDF"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "\"\<Done with the adding function\>\"", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", " ", "[", 
      RowBox[{"{", 
       RowBox[{"combPDF", ",", " ", 
        RowBox[{"rescalingFactor", " ", "*", " ", "probHeight"}], ",", " ", 
        "PDF2"}], " ", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.748857611520702*^9, 3.748857698097784*^9}, {
   3.748857747011385*^9, 3.7488578265975637`*^9}, {3.748858002551355*^9, 
   3.748858002591115*^9}, {3.74885805325637*^9, 3.74885808367243*^9}, {
   3.7488581528178368`*^9, 3.748858155321662*^9}, {3.7488584498217907`*^9, 
   3.748858453233735*^9}, {3.7488589086525507`*^9, 3.748858922631926*^9}, {
   3.748859162519928*^9, 3.748859174872546*^9}, {3.748860051380104*^9, 
   3.748860200246325*^9}, {3.748860380213591*^9, 3.7488604856347237`*^9}, {
   3.748860570115932*^9, 3.748860607356572*^9}, 3.748860663405435*^9, {
   3.748860755310708*^9, 3.748860756355258*^9}, {3.748860858080102*^9, 
   3.748860896744897*^9}, {3.74886096384982*^9, 3.748861158060019*^9}, {
   3.748861207173019*^9, 3.748861250053362*^9}, {3.748861298270136*^9, 
   3.748861317725933*^9}, {3.748861349934497*^9, 3.7488613736869783`*^9}, {
   3.748861404023675*^9, 3.748861432135878*^9}, {3.749113670691456*^9, 
   3.749113672723447*^9}, 3.749113782998982*^9, {3.7491139544132566`*^9, 
   3.749113979163618*^9}, {3.749114036300683*^9, 3.7491140382930317`*^9}, {
   3.749114091342922*^9, 3.7491141009396152`*^9}, {3.749114141457015*^9, 
   3.749114144461522*^9}, {3.749114175221274*^9, 3.749114230792097*^9}, {
   3.749114297933854*^9, 3.7491142982121897`*^9}, {3.749114428570552*^9, 
   3.749114447403482*^9}, {3.7491146456214027`*^9, 3.749114671563302*^9}, {
   3.749114731417699*^9, 3.749114735739252*^9}, {3.7491148092933407`*^9, 
   3.749114824554538*^9}, {3.7491149683009977`*^9, 3.7491150350258293`*^9}, {
   3.749115339889586*^9, 3.749115383732209*^9}, {3.749115416699831*^9, 
   3.749115437634502*^9}, {3.74911583663408*^9, 3.749115842785626*^9}, {
   3.749116155365376*^9, 3.749116166581212*^9}, {3.749116220302855*^9, 
   3.749116264344615*^9}, {3.7491163430449247`*^9, 3.749116401442699*^9}, {
   3.7491165619996347`*^9, 3.749116572706292*^9}, 3.749116619134521*^9, {
   3.74911696020289*^9, 3.749117001939643*^9}, {3.7491172563944893`*^9, 
   3.74911726871364*^9}, {3.74911736008214*^9, 3.749117408485498*^9}, {
   3.7491174653950233`*^9, 3.749117465892426*^9}, {3.749117590560733*^9, 
   3.7491176365157623`*^9}, {3.749117704562332*^9, 3.749117709763174*^9}, 
   3.74911782726793*^9, {3.749117922746449*^9, 3.7491179876853647`*^9}, {
   3.7491180837749777`*^9, 3.749118221826263*^9}, {3.749118795879714*^9, 
   3.749118829767164*^9}, 3.749118884362043*^9, {3.749119024369995*^9, 
   3.749119056363792*^9}, {3.749119190383462*^9, 3.749119197196015*^9}, {
   3.749119350210437*^9, 3.749119376641683*^9}},
 CellLabel->
  "In[4024]:=",ExpressionUUID->"e3d3e671-c56d-433a-a737-9cc414b1ddd9"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.748758757562752*^9, 3.7487587621177397`*^9}, 
   3.748758973161661*^9, {3.748762653398384*^9, 3.7487626540424643`*^9}, {
   3.748768849941877*^9, 3.748768878710067*^9}, {3.748795509395458*^9, 
   3.748795644437173*^9}, {3.748795698072341*^9, 3.748795844911716*^9}, {
   3.748795881361211*^9, 3.748795927409239*^9}, {3.748795997733556*^9, 
   3.748796233674861*^9}, {3.748796447856827*^9, 3.748796589123623*^9}, {
   3.748796673359838*^9, 3.748796976347329*^9}, 3.748855528037472*^9, {
   3.748856043077074*^9, 3.748856046868038*^9}, {3.74885675577384*^9, 
   3.7488567712859287`*^9}, {3.748856812166275*^9, 3.748856836313192*^9}, {
   3.7488568770236273`*^9, 3.748856881532566*^9}, {3.748856971472836*^9, 
   3.748857095674968*^9}, {3.748857130315008*^9, 3.7488571555312567`*^9}, {
   3.748857186707788*^9, 3.748857194043737*^9}, {3.74885725158918*^9, 
   3.748857279164624*^9}, {3.748857875130265*^9, 3.7488579976077003`*^9}, {
   3.748858093544983*^9, 3.748858182770135*^9}, {3.748858245435199*^9, 
   3.748858374709152*^9}, {3.748858405902748*^9, 3.7488584244306097`*^9}, {
   3.748858461710293*^9, 3.748858481806635*^9}, {3.7488585758651457`*^9, 
   3.7488585846327353`*^9}, {3.7488586159050426`*^9, 3.74885863620958*^9}, {
   3.748858689169096*^9, 3.748858693902347*^9}},
 ExpressionUUID -> "0b61cbae-f944-4fce-b37d-02d3a711d0b5"],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<PDF1, combPDFres\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pltRange", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "-", "1"}], ",", " ", 
       RowBox[{"b", "+", "1"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.6"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "=", "10"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]1", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "+", "1"}], ",", " ", 
      RowBox[{"b", "-", "1"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]2", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "+", "1"}], ",", " ", 
      RowBox[{"b", "-", "1"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]1", " ", "=", " ", "1.294"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]2", " ", "=", " ", "0.744"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"PDF1", " ", "=", " ", "0"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PDF1", " ", "=", " ", 
    RowBox[{"RandomChoice", " ", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{
        FractionBox["1", 
         RowBox[{"2", "\[Sigma]1"}]], "*", 
        RowBox[{"probUnifom", "[", 
         RowBox[{"x", ",", " ", 
          RowBox[{"\[Mu]1", "-", "\[Sigma]1"}], ",", " ", 
          RowBox[{"\[Mu]1", "+", "\[Sigma]1"}]}], "]"}]}]}], " ", "}"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"PDF2", " ", "=", " ", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"2", "\[Sigma]2"}]], "*", 
      RowBox[{"probUnifom", "[", 
       RowBox[{"x", ",", " ", 
        RowBox[{"\[Mu]2", "-", "\[Sigma]2"}], ",", " ", 
        RowBox[{"\[Mu]2", "+", "\[Sigma]2"}]}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Print", " ", "[", 
       RowBox[{"\"\<Total probability of PDF1 is : \>\"", ",", 
        RowBox[{"Quiet", "[", " ", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{"PDF1", ",", " ", 
           RowBox[{"{", 
            RowBox[{"x", ",", " ", "1", ",", " ", "10"}], "}"}]}], "]"}], 
         "]"}]}], " ", "]"}], "\[IndentingNewLine]", 
      RowBox[{"Print", " ", "[", 
       RowBox[{"\"\<Total probability of PDF2 is : \>\"", ",", 
        RowBox[{"Quiet", "[", " ", 
         RowBox[{"NIntegrate", "[", 
          RowBox[{"PDF2", ",", " ", 
           RowBox[{"{", 
            RowBox[{"x", ",", " ", "1", ",", " ", "10"}], "}"}]}], "]"}], 
         "]"}]}], " ", "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "rescFactAux"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"(", "\[Sigma]2", ")"}], " ", "/", " ", 
      RowBox[{"(", "\[Sigma]1", ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"PDF2", " ", "=", " ", 
     RowBox[{"PDF2", " ", "*", " ", "rescFactAux"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"combPDF", " ", "=", " ", 
     RowBox[{"PDF1", " ", "+", " ", "PDF2", "-", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", "\[Sigma]1"}], ")"}], "*", "PDF1", " ", "*", " ", 
       "PDF2"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"newArea", " ", "=", 
     RowBox[{"Quiet", "[", " ", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{"combPDF", ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", " ", "1", ",", " ", "10"}], "}"}]}], "]"}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"rescalingFactor", " ", "=", " ", 
     RowBox[{"1", "/", "newArea"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"combPDF", " ", "=", " ", 
     RowBox[{"rescalingFactor", " ", "*", " ", "combPDF"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", " ", "[", 
     RowBox[{"\"\<Total probability of the combined PDF is : \>\"", ",", 
      RowBox[{"Quiet", "[", " ", 
       RowBox[{"NIntegrate", "[", 
        RowBox[{"combPDF", ",", " ", 
         RowBox[{"{", 
          RowBox[{"x", ",", " ", "1", ",", " ", "10"}], "}"}]}], "]"}], 
       "]"}]}], " ", "]"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"currentHeight", " ", "=", " ", 
    FractionBox["1", 
     RowBox[{"2", "\[Sigma]1"}]]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"combPDFres", "=", " ", 
   RowBox[{"addToStepDist", "[", 
    RowBox[{
    "PDF1", ",", " ", "currentHeight", ",", " ", "\[Mu]2", ",", " ", 
     "\[Sigma]2"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"combPDFlocal", " ", "=", " ", 
   RowBox[{"combPDFres", "[", 
    RowBox[{"[", " ", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"addedPDF", " ", "=", " ", 
    RowBox[{"combPDFres", "[", 
     RowBox[{"[", "3", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"newHeight", " ", "=", " ", 
    RowBox[{"combPDFres", "[", 
     RowBox[{"[", " ", "2", " ", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", " ", "[", 
    RowBox[{"\"\<The total probability of thw new PDF is: \>\"", ",", " ", 
     RowBox[{"Quiet", "[", " ", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{"combPDFlocal", ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", " ", "1", ",", " ", "10"}], "}"}]}], "]"}], 
      "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"PDF1", ",", "   ", "combPDFlocal", ",", "addedPDF"}], "}"}], 
    ",", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", " ", "1", ",", " ", "10"}], "}"}], ",", " ", 
    RowBox[{"Filling", "\[Rule]", "Axis"}], ",", " ", 
    RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}], ",", " ", 
    RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", " ", 
      RowBox[{"Red", ",", 
       RowBox[{"PointSize", "@", "Large"}], ",", "   ", 
       RowBox[{"Point", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Mu]2", "-", "\[Sigma]2"}], ",", "0.001"}], "}"}], 
        "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "\[Rule]", "pltRange"}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]3", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "+", "1"}], ",", " ", 
      RowBox[{"b", "-", "1"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]3", " ", "=", " ", "0.2554"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"combPDFres2", " ", "=", " ", 
   RowBox[{"addToStepDist", "[", 
    RowBox[{
    "combPDFlocal", ",", " ", "newHeight", ",", " ", "\[Mu]3", ",", " ", 
     "\[Sigma]3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"combPDF2", " ", "=", " ", 
   RowBox[{"combPDFres2", "[", 
    RowBox[{"[", " ", "1", " ", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"addedPDF2", " ", "=", " ", 
    RowBox[{"combPDFres2", " ", "[", 
     RowBox[{"[", " ", "3", " ", "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", " ", "[", 
    RowBox[{"\"\<The total probability of thw new PDF is: \>\"", ",", " ", 
     RowBox[{"Quiet", "[", " ", 
      RowBox[{"NIntegrate", "[", 
       RowBox[{"combPDF2", ",", " ", 
        RowBox[{"{", 
         RowBox[{"x", ",", " ", "1", ",", " ", "10"}], "}"}]}], "]"}], 
      "]"}]}], "]"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Plot", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"combPDFlocal", ",", " ", "combPDF2", ",", " ", "addedPDF2"}], 
     "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", " ", "1", ",", " ", "10"}], "}"}], ",", " ", 
    RowBox[{"Filling", "\[Rule]", "Axis"}], ",", " ", 
    RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}], ",", " ", 
    RowBox[{"PlotStyle", "\[Rule]", "Thick"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", " ", 
      RowBox[{"Red", ",", 
       RowBox[{"PointSize", "@", "Large"}], ",", "   ", 
       RowBox[{"Point", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Mu]2", "-", "\[Sigma]2"}], ",", "0.001"}], "}"}], 
        "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "\[Rule]", "pltRange"}]}], "\[IndentingNewLine]", 
   "]"}], "\n"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.748758757562752*^9, 3.7487587621177397`*^9}, 
   3.748758973161661*^9, {3.748762653398384*^9, 3.7487626540424643`*^9}, {
   3.748768849941877*^9, 3.748768878710067*^9}, {3.748795509395458*^9, 
   3.748795644437173*^9}, {3.748795698072341*^9, 3.748795844911716*^9}, {
   3.748795881361211*^9, 3.748795927409239*^9}, {3.748795997733556*^9, 
   3.748796233674861*^9}, {3.748796447856827*^9, 3.748796589123623*^9}, {
   3.748796673359838*^9, 3.748796976347329*^9}, 3.748855528037472*^9, {
   3.748856043077074*^9, 3.748856046868038*^9}, {3.74885675577384*^9, 
   3.7488567712859287`*^9}, {3.748856812166275*^9, 3.748856836313192*^9}, {
   3.7488568770236273`*^9, 3.748856881532566*^9}, {3.748856971472836*^9, 
   3.748857095674968*^9}, {3.748857130315008*^9, 3.7488571555312567`*^9}, {
   3.748857186707788*^9, 3.748857194043737*^9}, {3.74885725158918*^9, 
   3.748857279164624*^9}, {3.748857875130265*^9, 3.7488579976077003`*^9}, {
   3.748858093544983*^9, 3.748858182770135*^9}, {3.748858245435199*^9, 
   3.748858374709152*^9}, {3.748858405902748*^9, 3.7488584244306097`*^9}, {
   3.748858461710293*^9, 3.748858481806635*^9}, {3.7488585758651457`*^9, 
   3.7488585846327353`*^9}, {3.7488586159050426`*^9, 3.74885863620958*^9}, {
   3.7488586998104486`*^9, 3.748858710338317*^9}, {3.748858823299711*^9, 
   3.748858886876684*^9}, {3.748858932940441*^9, 3.748858934745899*^9}, {
   3.748858982670404*^9, 3.748859003061795*^9}, {3.748859713512911*^9, 
   3.748859781133995*^9}, {3.748859851409827*^9, 3.748859861017874*^9}, 
   3.7488599031478567`*^9, {3.748859938684585*^9, 3.7488599710995417`*^9}, {
   3.748860032060809*^9, 3.748860035156013*^9}, {3.7488602561362257`*^9, 
   3.748860277471266*^9}, 3.748860309612463*^9, {3.7488604948993893`*^9, 
   3.748860499887929*^9}, {3.748860667782112*^9, 3.74886068345977*^9}, {
   3.7488613880228167`*^9, 3.7488613901566153`*^9}, {3.748861448224976*^9, 
   3.748861451126176*^9}, {3.748861490873266*^9, 3.748861500913081*^9}, {
   3.7488616003948803`*^9, 3.748861604538808*^9}, {3.74886175064467*^9, 
   3.748861774933846*^9}, {3.748861828589567*^9, 3.748861834228114*^9}, {
   3.7491133604536943`*^9, 3.7491134308785954`*^9}, {3.749113473952971*^9, 
   3.749113547919052*^9}, {3.749113582957007*^9, 3.7491136082830343`*^9}, {
   3.749113798497982*^9, 3.7491138063212833`*^9}, {3.7491138601202097`*^9, 
   3.749113860535738*^9}, {3.749114389069674*^9, 3.749114392285527*^9}, {
   3.74911448591791*^9, 3.749114492182242*^9}, {3.749114539623979*^9, 
   3.74911453991013*^9}, {3.749114891505969*^9, 3.749114893232431*^9}, {
   3.749114947420874*^9, 3.7491149839063168`*^9}, {3.74911524015729*^9, 
   3.749115240378771*^9}, {3.749115605393436*^9, 3.749115688778385*^9}, {
   3.749116065561985*^9, 3.749116067312068*^9}, {3.74911649776576*^9, 
   3.7491165103240128`*^9}, 3.749117024473782*^9, {3.749117098322175*^9, 
   3.749117173002264*^9}, {3.7491172179266243`*^9, 3.749117242287661*^9}, {
   3.749117390309861*^9, 3.749117455977497*^9}, 3.749117499125456*^9, {
   3.7491177415651207`*^9, 3.749117742072876*^9}, {3.749117778300991*^9, 
   3.749117785732349*^9}, {3.749117867639625*^9, 3.749117872543117*^9}, {
   3.749118006378903*^9, 3.749118014358953*^9}, {3.7491180493713417`*^9, 
   3.749118049727906*^9}, 3.749118135108247*^9, 3.749118199518304*^9, {
   3.749118890110897*^9, 3.749118904905981*^9}},
 CellLabel->
  "In[3973]:=",ExpressionUUID->"0b61cbae-f944-4fce-b37d-02d3a711d0b5"]
}, Open  ]]
},
WindowSize->{1440, 855},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.25,
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 318, 6, 64, "Input",ExpressionUUID->"bfcec826-eaec-4a83-992d-6e9e02e6819d"],
Cell[CellGroupData[{
Cell[901, 30, 171, 3, 84, "Section",ExpressionUUID->"09ea2822-3c08-4072-bb7f-327051056910"],
Cell[1075, 35, 971, 24, 90, "Input",ExpressionUUID->"59df87fe-7b84-4db1-a615-66cec0424fb4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2083, 64, 154, 3, 84, "Section",ExpressionUUID->"733d2676-ca2f-47ee-882c-bb5dc7085eca"],
Cell[2240, 69, 23214, 478, 3912, "Input",ExpressionUUID->"34530e34-0e7f-411b-9e19-707619d2244c"],
Cell[25457, 549, 6637, 129, 1130, "Input",ExpressionUUID->"e3d3e671-c56d-433a-a737-9cc414b1ddd9"],
Cell[32097, 680, 1384, 19, 37, "Input",ExpressionUUID->"0b61cbae-f944-4fce-b37d-02d3a711d0b5"],
Cell[33484, 701, 12708, 289, 1730, "Input",ExpressionUUID->"0b61cbae-f944-4fce-b37d-02d3a711d0b5"]
}, Open  ]]
}
]
*)

